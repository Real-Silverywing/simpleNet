Loaded configuration from  ./configs/config.json

{'TTA_folds': 3,
 'batch_size': 1,
 'clip_size': 64,
 'cosine_annealing': False,
 'dataloader': 'kpdataloader',
 'decoder': 'LSTM',
 'decoder_dim': 256,
 'desc': 'tempspatattnnet net with global54',
 'disc_exp_name': '',
 'drop_rate': 0,
 'epochs': 10,
 'es_patience': 284,
 'exclude_ext_data': False,
 'exp_name': 'colonoscopy_test',
 'focal_gamma': 2,
 'force_subsample': False,
 'fp16': False,
 'group_drsl': False,
 'group_label': False,
 'imsize': 256,
 'lr': 0.001,
 'lr_patience': 128,
 'lr_scale': 0.1,
 'model_name': 'simplenet',
 'model_type': '',
 'nclips': 1,
 'num_classes': 1,
 'num_workers': 1,
 'pos_weight': 1,
 'processed_run': '',
 'random_interval': False,
 'reduce_lr_plateau': True,
 'select': False,
 'spatial_attn': True,
 'spatial_attn_pool': False,
 'step_size': 4,
 'temporal_attention': True,
 'temporal_attention_softmax': True,
 'trajectory': False,
 'unfreeze_rgb': False,
 'use_rgb_base': True,
 'weighted_bce': False}

Using CUDA
*************************************
Training model with Val Fold = 1, Test Fold = 2
DEBUG: getting kpdataloader
Loading folds from ./data/April2019/folds4/
                                                    0  1
0   ./data/April2019/image_extract/fold3/vid_101_t...  1
1   ./data/April2019/image_extract/fold3/vid_102_t...  1
2   ./data/April2019/image_extract/fold3/vid_104_t...  1
3   ./data/April2019/image_extract/fold3/vid_106_t...  1
4   ./data/April2019/image_extract/fold3/vid_107_t...  1
5   ./data/April2019/image_extract/fold3/vid_112_t...  0
6   ./data/April2019/image_extract/fold3/vid_118_t...  1
7   ./data/April2019/image_extract/fold3/vid_119_t...  1
8   ./data/April2019/image_extract/fold3/vid_122_t...  0
9   ./data/April2019/image_extract/fold3/vid_128_t...  0
10  ./data/April2019/image_extract/fold3/vid_129_t...  1
11  ./data/April2019/image_extract/fold3/vid_130_t...  1
12  ./data/April2019/image_extract/fold3/vid_143_t...  0
13  ./data/April2019/image_extract/fold3/vid_154_t...  1
14  ./data/April2019/image_extract/fold3/vid_158_t...  1
15  ./data/April2019/image_extract/fold3/vid_161_t...  1
16  ./data/April2019/image_extract/fold3/vid_164_t...  1
17  ./data/April2019/image_extract/fold3/vid_169_t...  1
18  ./data/April2019/image_extract/fold3/vid_173_t...  1
19  ./data/April2019/image_extract/fold4/vid_103_t...  1
20  ./data/April2019/image_extract/fold4/vid_108_t...  0
21  ./data/April2019/image_extract/fold4/vid_113_t...  0
22  ./data/April2019/image_extract/fold4/vid_116_t...  1
23  ./data/April2019/image_extract/fold4/vid_120_t...  1
24  ./data/April2019/image_extract/fold4/vid_123_t...  1
25  ./data/April2019/image_extract/fold4/vid_131_t...  1
26  ./data/April2019/image_extract/fold4/vid_134_t...  1
27  ./data/April2019/image_extract/fold4/vid_150_t...  1
28  ./data/April2019/image_extract/fold4/vid_159_t...  1
29  ./data/April2019/image_extract/fold4/vid_162_t...  1
30  ./data/April2019/image_extract/fold4/vid_165_t...  1
31  ./data/April2019/image_extract/fold4/vid_167_t...  0
32  ./data/April2019/image_extract/fold4/vid_171_t...  0
33  ./data/April2019/image_extract/fold4/vid_181_t...  1
34  ./data/April2019/image_extract/fold4/vid_182c_...  1
35  ./data/April2019/image_extract/fold4/vid_182d_...  1
36  ./data/April2019/image_extract/fold4/vid_182e_...  1
num_frames: 4510 in vid: ./data/April2019/image_extract/fold3/vid_101_trim/
num_frames: 4099 in vid: ./data/April2019/image_extract/fold3/vid_102_trim/
num_frames: 1866 in vid: ./data/April2019/image_extract/fold3/vid_104_trim/
num_frames: 2376 in vid: ./data/April2019/image_extract/fold3/vid_106_trim/
num_frames: 2578 in vid: ./data/April2019/image_extract/fold3/vid_107_trim/
num_frames: 1330 in vid: ./data/April2019/image_extract/fold3/vid_112_trim/
num_frames: 3041 in vid: ./data/April2019/image_extract/fold3/vid_118_trim/
num_frames: 2459 in vid: ./data/April2019/image_extract/fold3/vid_119_trim/
num_frames: 7248 in vid: ./data/April2019/image_extract/fold3/vid_122_trim/
num_frames: 7104 in vid: ./data/April2019/image_extract/fold3/vid_128_trim/
num_frames: 5312 in vid: ./data/April2019/image_extract/fold3/vid_129_trim/
num_frames: 3059 in vid: ./data/April2019/image_extract/fold3/vid_130_trim/
num_frames: 4112 in vid: ./data/April2019/image_extract/fold3/vid_143_trim/
num_frames: 3841 in vid: ./data/April2019/image_extract/fold3/vid_154_trim/
num_frames: 3179 in vid: ./data/April2019/image_extract/fold3/vid_158_trim/
num_frames: 3600 in vid: ./data/April2019/image_extract/fold3/vid_161_trim/
num_frames: 1471 in vid: ./data/April2019/image_extract/fold3/vid_164_trim/
num_frames: 3455 in vid: ./data/April2019/image_extract/fold3/vid_169_trim/
num_frames: 4931 in vid: ./data/April2019/image_extract/fold3/vid_173_trim/
num_frames: 4193 in vid: ./data/April2019/image_extract/fold4/vid_103_trim/
num_frames: 5974 in vid: ./data/April2019/image_extract/fold4/vid_108_trim/
num_frames: 8366 in vid: ./data/April2019/image_extract/fold4/vid_113_trim/
num_frames: 3059 in vid: ./data/April2019/image_extract/fold4/vid_116_trim/
num_frames: 3072 in vid: ./data/April2019/image_extract/fold4/vid_120_trim/
num_frames: 1514 in vid: ./data/April2019/image_extract/fold4/vid_123_trim/
num_frames: 3896 in vid: ./data/April2019/image_extract/fold4/vid_131_trim/
num_frames: 2982 in vid: ./data/April2019/image_extract/fold4/vid_134_trim/
num_frames: 4912 in vid: ./data/April2019/image_extract/fold4/vid_150_trim/
num_frames: 5803 in vid: ./data/April2019/image_extract/fold4/vid_159_trim/
num_frames: 8011 in vid: ./data/April2019/image_extract/fold4/vid_162_trim/
num_frames: 2241 in vid: ./data/April2019/image_extract/fold4/vid_165_trim/
num_frames: 2274 in vid: ./data/April2019/image_extract/fold4/vid_167_trim/
num_frames: 4086 in vid: ./data/April2019/image_extract/fold4/vid_171_trim/
num_frames: 3340 in vid: ./data/April2019/image_extract/fold4/vid_181_trim/
num_frames: 1289 in vid: ./data/April2019/image_extract/fold4/vid_182c_trim/
num_frames: 1936 in vid: ./data/April2019/image_extract/fold4/vid_182d_trim/
num_frames: 2623 in vid: ./data/April2019/image_extract/fold4/vid_182e_trim/
num_frames: 1821 in vid: ./data/April2019/image_extract/fold1/vid_105_trim/
num_frames: 4441 in vid: ./data/April2019/image_extract/fold1/vid_115_trim/
num_frames: 1433 in vid: ./data/April2019/image_extract/fold1/vid_117_trim/
num_frames: 4153 in vid: ./data/April2019/image_extract/fold1/vid_124_trim/
num_frames: 3943 in vid: ./data/April2019/image_extract/fold1/vid_125_trim/
num_frames: 4469 in vid: ./data/April2019/image_extract/fold1/vid_127_trim/
num_frames: 2850 in vid: ./data/April2019/image_extract/fold1/vid_133_trim/
num_frames: 8724 in vid: ./data/April2019/image_extract/fold1/vid_138_trim/
num_frames: 7003 in vid: ./data/April2019/image_extract/fold1/vid_144_trim/
num_frames: 3832 in vid: ./data/April2019/image_extract/fold1/vid_151_trim/
num_frames: 6135 in vid: ./data/April2019/image_extract/fold1/vid_156_trim/
num_frames: 4525 in vid: ./data/April2019/image_extract/fold1/vid_157_trim/
num_frames: 3135 in vid: ./data/April2019/image_extract/fold1/vid_170_trim/
num_frames: 2283 in vid: ./data/April2019/image_extract/fold1/vid_174_trim/
num_frames: 2847 in vid: ./data/April2019/image_extract/fold1/vid_176_trim/
num_frames: 2361 in vid: ./data/April2019/image_extract/fold1/vid_182a_trim/
num_frames: 1020 in vid: ./data/April2019/image_extract/fold1/vid_182b_trim/
num_frames: 1825 in vid: ./data/April2019/image_extract/fold1/vid_182f_trim/
num_frames: 2808 in vid: ./data/April2019/image_extract/fold1/vid_182g_trim/
num_frames: 1425 in vid: ./data/April2019/image_extract/fold2/vid_111_trim/
num_frames: 3868 in vid: ./data/April2019/image_extract/fold2/vid_114_trim/
num_frames: 2910 in vid: ./data/April2019/image_extract/fold2/vid_121_trim/
num_frames: 2312 in vid: ./data/April2019/image_extract/fold2/vid_126_trim/
num_frames: 3611 in vid: ./data/April2019/image_extract/fold2/vid_132_trim/
num_frames: 3819 in vid: ./data/April2019/image_extract/fold2/vid_136_trim/
num_frames: 4365 in vid: ./data/April2019/image_extract/fold2/vid_137_trim/
num_frames: 8009 in vid: ./data/April2019/image_extract/fold2/vid_140_trim/
num_frames: 1805 in vid: ./data/April2019/image_extract/fold2/vid_147_trim/
num_frames: 1933 in vid: ./data/April2019/image_extract/fold2/vid_148_trim/
num_frames: 2363 in vid: ./data/April2019/image_extract/fold2/vid_149_trim/
num_frames: 3561 in vid: ./data/April2019/image_extract/fold2/vid_152_trim/
num_frames: 1236 in vid: ./data/April2019/image_extract/fold2/vid_155_trim/
num_frames: 7375 in vid: ./data/April2019/image_extract/fold2/vid_163_trim/
num_frames: 3238 in vid: ./data/April2019/image_extract/fold2/vid_166_trim/
num_frames: 2711 in vid: ./data/April2019/image_extract/fold2/vid_175_trim/
num_frames: 7336 in vid: ./data/April2019/image_extract/fold2/vid_177_trim/
num_frames: 5815 in vid: ./data/April2019/image_extract/fold2/vid_180_trim/
num_frames: 1907 in vid: ./data/April2019/image_extract/fold2/vid_184_trim/
Training ...
Saving to  ./model_weights/colonoscopy_test/best_simplenet_val1_test2.pth

Epoch 0/10
length train_loader37
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])
DEBUG: imgs size=torch.Size([1, 64, 3, 224, 224])

Avg Train Loss: 0.6433
